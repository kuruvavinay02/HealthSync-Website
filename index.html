<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=1200, initial-scale=1" />
  <title>HealthSync+ â€” Your smart health companion</title>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Optional PWA manifest placeholder (create manifest.json separately) -->
  <!-- <link rel="manifest" href="manifest.json"> -->

  <style>
    /* ====== GLOBAL & LAYOUT (laptop-first) ====== */
    :root{
      --bg: #f6f9fb;
      --card: #ffffff;
      --accent: linear-gradient(135deg,#2bb7b2 0%,#3aa0ff 100%);
      --muted:#6b7280;
      --glass: rgba(255,255,255,0.6);
      --success:#2ecc71;
      --danger:#ff6b6b;
      --shadow: 0 6px 20px rgba(14,30,37,0.08);
      --radius:14px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:#0b1320}
    .container{
      width:1200px;
      margin:28px auto;
      display:grid;
      grid-template-columns: 320px 1fr 360px;
      gap:20px;
      align-items:start;
    }
    header{
      grid-column:1/-1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:8px;
    }
    h1{margin:0;font-size:22px;letter-spacing:0.2px}
    .sub{color:var(--muted);font-size:13px}

    /* ====== SIDEBAR ====== */
    .sidebar{
      background:var(--card);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:var(--shadow);
      position:sticky; top:24px;
      height:calc(100vh - 100px);
      overflow:auto;
    }
    .profile{display:flex;gap:12px;align-items:center}
    .avatar{
      width:56px;height:56px;border-radius:12px;
      background:linear-gradient(180deg,#a6f3e1,#6ec6ff);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:#04303a;
    }
    nav ul{list-style:none;padding:12px 0;margin:0}
    nav li{padding:10px;border-radius:10px;cursor:pointer;color:#0b1320}
    nav li:hover{background:#f1f6fb}
    .small{font-size:12px;color:var(--muted)}

    /* ====== MAIN (CENTER) ====== */
    .main{
      display:flex;flex-direction:column;gap:16px;
    }
    .card{
      background:var(--card);
      border-radius:14px;
      padding:16px;
      box-shadow:var(--shadow);
    }
    .row{display:flex;gap:16px;align-items:center}
    .col{flex:1}

    /* Dashboard cards */
    .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    .stat{
      padding:14px;border-radius:12px;background:linear-gradient(180deg,rgba(58,160,255,0.08),rgba(43,183,178,0.02));
    }
    .stat h3{margin:0;font-size:20px}
    .muted{color:var(--muted);font-size:12px}

    /* Heartbeat */
    .heart-wrapper{display:flex;gap:16px;align-items:center}
    .heart{
      width:88px;height:88px;border-radius:50%;
      background:radial-gradient(circle at 40% 30%,#ff6b9a,#ff3d6a 60%);
      box-shadow: 0 8px 30px rgba(255,77,123,0.18);
      display:flex;align-items:center;justify-content:center;color:white;font-weight:700;
      transform-origin:center;
      animation:beat 1.1s infinite;
    }
    @keyframes beat {
      0%{transform:scale(1)}
      20%{transform:scale(1.18)}
      40%{transform:scale(0.92)}
      60%{transform:scale(1.08)}
      100%{transform:scale(1)}
    }

    /* Checklists */
    .checklist li{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px dashed #eef2f7}
    .checklist li:last-child{border-bottom:none}
    .checklist input[type=checkbox]{width:18px;height:18px}

    /* breathing */
    .breath-circle{
      width:160px;height:160px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg,rgba(58,160,255,0.08),rgba(43,183,178,0.02));
      position:relative;
      overflow:hidden;
    }
    .breathing{
      width:110px;height:110px;border-radius:50%;
      background:var(--accent);
      display:flex;align-items:center;justify-content:center;color:white;font-weight:600;
      transform-origin:center;
      transition:transform 3s ease-in-out;
      box-shadow:0 8px 20px rgba(10,80,180,0.1);
    }

    /* right column */
    .right{
      position:sticky; top:24px;height:calc(100vh - 100px);overflow:auto;padding-bottom:40px;
    }
    .quote{font-size:15px;font-weight:600}
    .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:#f1f8ff;margin:4px;font-size:12px;color:#0b4a6f}

    /* Buttons and FAB */
    .btn{
      padding:10px 14px;border-radius:12px;border:0;background:linear-gradient(90deg,#2bb7b2,#3aa0ff);
      color:white;cursor:pointer;font-weight:600;
      box-shadow: 0 6px 16px rgba(51,122,255,0.12);
    }
    .btn-ghost{background:transparent;border:1px solid #e6eefb;color:#0b1320}
    .fab{
      position:fixed;right:40px;bottom:40px;background:linear-gradient(90deg,#ff6b6b,#ff9a6b);width:64px;height:64px;border-radius:20px;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;box-shadow:0 18px 40px rgba(255,105,105,0.16);cursor:pointer
    }

    /* small responsive (still laptop) */
    @media (max-width:1300px){
      .container{width:95%;grid-template-columns:280px 1fr 320px}
    }
    @media (max-width:1024px){
      .container{grid-template-columns:1fr; padding:16px}
      .sidebar,.right{position:static;height:auto}
      header{flex-direction:column;align-items:flex-start;gap:8px}
      .fab{right:18px;bottom:18px}
    }

    /* little micro-interactions */
    .card:hover{transform:translateY(-4px);transition:transform 0.18s}
    .tiny{font-size:12px;color:var(--muted)}
    input,select,textarea{font-family:inherit}
    .badge{padding:6px 8px;border-radius:8px;background:#effbf8;color:#0b5e4c;font-weight:700;font-size:12px}
    .progress{height:12px;background:#eef5f6;border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,#2bb7b2,#3aa0ff)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>HealthSync+ <span class="tiny">â€” Your smart health companion</span></h1>
        <div class="sub">Simulated AI insights â€¢ Local storage persistence â€¢ Laptop-optimized</div>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <div class="small">Welcome, <strong>Vinay</strong></div>
        <button class="btn" id="addLogBtn">+ Add Log</button>
      </div>
    </header>

    <!-- LEFT SIDEBAR -->
    <aside class="sidebar">
      <div class="profile">
        <div class="avatar">VS</div>
        <div>
          <div style="font-weight:700">Vinay</div>
          <div class="small">Student â€¢ ECE â€¢ Builds cool hacks</div>
        </div>
      </div>

      <nav>
        <ul>
          <li onclick="showSection('home')">Home</li>
          <li onclick="showSection('dashboard')">Dashboard</li>
          <li onclick="showSection('mental')">Mental Health</li>
          <li onclick="showSection('articles')">Articles</li>
          <li onclick="showSection('challenges')">Challenges</li>
          <li onclick="showSection('tools')">Tools</li>
        </ul>
      </nav>

      <div style="margin-top:12px">
        <div class="small">Daily progress</div>
        <ul class="checklist" id="dailyChecklist">
          <li><input type="checkbox" data-key="waterGoal"> 8 glasses of water</li>
          <li><input type="checkbox" data-key="walk30"> 30-min walk</li>
          <li><input type="checkbox" data-key="sleep7"> 7 hrs sleep</li>
          <li><input type="checkbox" data-key="meditate"> Meditation</li>
          <li style="padding-top:8px"><button class="btn-ghost" id="clearChecklist">Clear</button></li>
        </ul>
      </div>
      

      <div style="margin-top:18px">
        <div class="small">Newsletter</div>
        <form id="newsletterForm" onsubmit="return false;">
          <input id="newsletterEmail" placeholder="your@email.com" style="width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #eef6fb">
          <div style="margin-top:8px"><button class="btn" id="subscribeBtn">Subscribe</button></div>
          <div id="subscribeMsg" class="tiny" style="margin-top:8px;color:var(--muted)"></div>
        </form>
      </div>

      <div style="margin-top:18px">
        <div class="small">Nearby (demo)</div>
        <iframe title="map" src="https://www.google.com/maps?q=hospitals&output=embed" style="width:100%;height:200px;border:0;margin-top:8px;border-radius:8px;"></iframe>
      </div>
    </aside>

    <!-- CENTER -->
    <main class="main">
      <!-- Home -->
      <section id="home" class="card" style="display:block">
        <div class="row" style="justify-content:space-between;align-items:flex-start">
          <div>
            <h2 style="margin:0 0 8px 0">Welcome back, Vinay ðŸ‘‹</h2>
            <div class="muted">Here's your summary and quick actions for today.</div>
          </div>

          <div style="display:flex;gap:12px;align-items:center">
            <div class="chip" id="lastSync">Last sync: never</div>
            <div class="chip">Laptop view</div>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="stats">
          <div class="stat">
            <div class="muted">Steps (today)</div>
            <h3 id="stepsCount">0</h3>
            <div class="tiny">Goal: 7,000 steps</div>
          </div>
          <div class="stat">
            <div class="muted">Sleep (last night)</div>
            <h3 id="sleepHours">0 hr</h3>
            <div class="tiny">Aim: 7â€“8 hrs</div>
          </div>
          <div class="stat">
            <div class="muted">Water</div>
            <h3 id="waterCount">0 / 8</h3>
            <div class="tiny">Hydration progress</div>
          </div>
        </div>

        <div style="height:14px"></div>

        <div class="row">
          <div class="card col" style="padding:16px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div class="tiny">AI Wellness Insights</div>
                <h3 style="margin:6px 0">Personalized suggestions</h3>
              </div>
              <div style="text-align:right">
                <div class="muted tiny">Rule-based</div>
                <div class="tiny" id="insightTime"></div>
              </div>
            </div>

            <div id="insights" style="margin-top:12px"></div>
            <div style="margin-top:10px" class="tiny muted">*Simulated guidance â€” not medical advice.</div>
          </div>

          <div class="card" style="width:360px;padding:16px">
            <div class="heart-wrapper">
              <div>
                <div class="muted tiny">Realtime heartbeat</div>
                <div class="heart" id="heartBeat">80</div>
                <div class="tiny muted" style="margin-top:6px">Pulse (simulated)</div>
              </div>

              <div style="margin-left:8px">
                <div class="muted tiny">Breathing exercise</div>
                <div class="breath-circle" style="margin-top:8px">
                  <div class="breathing" id="breathingCtl">Breathe</div>
                </div>
                <div style="margin-top:8px;display:flex;gap:8px">
                  <button class="btn" id="startBreath">Start 1-min</button>
                  <button class="btn-ghost" id="stopBreath">Stop</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Dashboard -->
      <section id="dashboard" class="card" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h2 style="margin:0">Dashboard</h2>
          <div class="muted tiny">Overview â€¢ Weekly trends</div>
        </div>

        <div style="height:12px"></div>

        <!-- Charts -->
        <div style="display:flex;gap:16px;">
          <div style="flex:1">
            <canvas id="stepsChart" height="140"></canvas>
          </div>
          <div style="width:360px">
            <canvas id="sleepChart" height="140"></canvas>
            <div style="height:12px"></div>
            <canvas id="moodChart" height="140"></canvas>
          </div>
        </div>

        <div style="height:14px"></div>

        <div style="display:flex;gap:12px">
          <div style="flex:1" class="card">
            <h3 style="margin:0 0 8px 0">Wellness Challenges</h3>
            <div class="tiny muted">7-day Hydration Challenge</div>
            <div style="height:10px"></div>
            <div class="progress"><i id="hydrationProgress" style="width:20%"></i></div>
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="small">Consistency: 3 / 7 days</div>
              <button class="btn" id="joinChallenge">Join</button>
            </div>
          </div>

          <div style="width:360px" class="card">
            <h3 style="margin:0 0 8px 0">BMI & Calories</h3>
            <div class="tiny muted">Quick calculator</div>
            <div style="height:8px"></div>
            <div style="display:flex;gap:8px">
              <input id="heightInput" placeholder="Height cm" style="flex:1;padding:8px;border-radius:8px;border:1px solid #eef6fb">
              <input id="weightInput" placeholder="Weight kg" style="flex:1;padding:8px;border-radius:8px;border:1px solid #eef6fb">
            </div>
            <div style="height:8px"></div>
            <select id="activityLevel" style="width:100%;padding:8px;border-radius:8px;border:1px solid #eef6fb">
              <option value="1.2">Sedentary</option>
              <option value="1.375">Lightly active</option>
              <option value="1.55">Moderately active</option>
              <option value="1.725">Very active</option>
              <option value="1.9">Extra active</option>
            </select>
            <div style="height:8px"></div>
            <div style="display:flex;gap:8px">
              <button class="btn" id="calcBtn">Calculate</button>
              <button class="btn-ghost" id="clearCalc">Clear</button>
            </div>
            <div style="height:10px"></div>
            <div id="bmiResult" class="tiny muted"></div>
          </div>
        </div>
      </section>

      <!-- Mental Health -->
      <section id="mental" class="card" style="display:none">
        <h2>Mind & Mood</h2>
        <div class="muted tiny">Log mood entries and short notes</div>
        <div style="height:12px"></div>

        <div style="display:flex;gap:12px">
          <div style="flex:1" class="card">
            <div style="display:flex;gap:8px;align-items:center">
              <select id="moodSelect" style="padding:8px;border-radius:8px;border:1px solid #eef6fb">
                <option>Happy</option>
                <option>Calm</option>
                <option>Anxious</option>
                <option>Sad</option>
                <option>Neutral</option>
              </select>
              <input id="moodNote" placeholder="short note..." style="flex:1;padding:8px;border-radius:8px;border:1px solid #eef6fb">
              <button class="btn" id="addMood">Add</button>
            </div>

            <ul id="moodList" style="margin-top:12px"></ul>
          </div>

          <div style="width:360px" class="card">
            <h3 style="margin:0 0 8px 0">Mindful breathing</h3>
            <div class="tiny muted">A simple 1-minute guided exercise</div>
            <div style="height:10px"></div>
            <div style="display:flex;gap:8px">
              <button class="btn" id="startBreath2">Start breathing</button>
              <button class="btn-ghost" id="stopBreath2">Stop</button>
            </div>
            <div style="height:12px"></div>
            <div id="breathingProgress" class="tiny muted">Ready</div>
          </div>
        </div>
      </section>

      <!-- Articles (demo list) -->
      <section id="articles" class="card" style="display:none">
        <h2>Articles & News</h2>
        <div class="tiny muted">Curated demo articles</div>

        <ul style="margin-top:12px">
          <li style="padding:10px 0;border-bottom:1px solid #f3f6fb">
            <strong>Walking 15 Minutes a Day May Lower Heart Disease Risk</strong>
            <div class="muted tiny">Learn how to maximize short walks.</div>
          </li>
          <li style="padding:10px 0;border-bottom:1px solid #f3f6fb">
            <strong>Calorie Counting for Weight Loss: Worth the Fuss?</strong>
            <div class="muted tiny">Pros & cons of tracking intake.</div>
          </li>
          <li style="padding:10px 0;border-bottom:1px solid #f3f6fb">
            <strong>9 Turmeric Recipes for Better Health</strong>
            <div class="muted tiny">Recipes & tips.</div>
          </li>
        </ul>
      </section>

      <!-- Challenges -->
      <section id="challenges" class="card" style="display:none">
        <h2>Challenges</h2>
        <div class="tiny muted">Gamified wellness streaks</div>
        <div style="height:10px"></div>

        <div style="display:flex;gap:12px">
          <div style="flex:1" class="card">
            <h3 style="margin:0">Hydration â€” 7 days</h3>
            <div class="tiny muted">Log 8 glasses for 7 days</div>
            <div style="height:8px"></div>
            <div class="progress"><i id="challengeProg" style="width:40%"></i></div>
            <div style="height:8px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="small">Progress: 3/7</div>
              <button class="btn" id="logGlass">I drank a glass</button>
            </div>
          </div>

          <div style="width:360px" class="card">
            <h3 style="margin:0">Sleep 8 hrs / 5 days</h3>
            <div class="tiny muted">Aim for consistent sleep</div>
            <div style="height:8px"></div>
            <div class="progress"><i id="sleepChallenge" style="width:20%"></i></div>
            <div style="height:8px"></div>
            <div class="small">Consistency matters!</div>
          </div>
        </div>
      </section>

      <!-- Tools -->
      <section id="tools" class="card" style="display:none">
        <h2>Tools</h2>
        <div class="tiny muted">Virtual doctor (simulated)</div>
        <div style="height:8px"></div>

        <div style="display:flex;gap:8px;align-items:center">
          <select id="symptomSel" style="padding:8px;border-radius:8px;border:1px solid #eef6fb">
            <option value="">Pick a symptom</option>
            <option>Headache</option>
            <option>Fatigue</option>
            <option>Cough</option>
            <option>Stomach ache</option>
            <option>Back pain</option>
          </select>
          <button class="btn" id="checkSymptom">Check</button>
        </div>

        <div style="height:12px"></div>
        <div id="symptomAdvice" class="card tiny muted"></div>
      </section>
    </main>

    <!-- RIGHT COLUMN -->
    <aside class="right">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="small">Motivation</div>
            <div class="quote" id="quoteText">"Health is the greatest wealth."</div>
            <div class="tiny muted">â€” Rotating daily</div>
          </div>
          <div>
            <button class="btn" id="newQuote">Refresh</button>
          </div>
        </div>
        <div style="height:12px"></div>
        <div class="tiny muted">Tags</div>
        <div style="margin-top:8px">
          <span class="chip">Wellness</span><span class="chip">Sleep</span><span class="chip">Fitness</span>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="card">
        <h3 style="margin:0 0 8px 0">Quick actions</h3>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button class="btn" id="startRemBtn">Start Water Reminder</button>
          <button class="btn-ghost" id="stopRemBtn">Stop Reminders</button>
          <button class="btn" id="openDashboard">Open Dashboard</button>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="card">
        <h3 style="margin:0 0 8px 0">Recent Logs</h3>
        <div id="recentLogs" class="tiny muted">No activity</div>
      </div>
    </aside>
  </div>

  <div class="fab" id="fabQuick">+</div>

  <!-- ====== SCRIPTS (app logic) ====== -->
  <script>
    /* ==========================
       Simple SPA navigation
       ========================== */
    function showSection(id){
      document.querySelectorAll('main section').forEach(s=>s.style.display='none');
      const el = document.getElementById(id);
      if(el) el.style.display='block';
      // update last sync
      document.getElementById('lastSync').textContent = 'Last sync: ' + (new Date()).toLocaleString();
    }
    document.getElementById('openDashboard').addEventListener('click',()=>showSection('dashboard'));
    document.querySelectorAll('nav li').forEach(n=>n.addEventListener('click',()=>{}));
    document.getElementById('fabQuick').addEventListener('click',()=>{ showSection('tools'); window.scrollTo(0,0); });

    /* ==========================
       Local storage helpers
       ========================== */
    const storage = {
      get(k,def){ try{ const v=localStorage.getItem(k); return v?JSON.parse(v):def;}catch(e){return def}},
      set(k,v){ localStorage.setItem(k,JSON.stringify(v)); }
    };

    /* ==========================
       Checklist persistence
       ========================== */
    function initChecklist(){
      document.querySelectorAll('#dailyChecklist input[type=checkbox]').forEach(cb=>{
        const key = cb.dataset.key;
        cb.checked = storage.get('check_'+key,false);
        cb.addEventListener('change', ()=> {
          storage.set('check_'+key, cb.checked);
          renderRecent('Checklist updated');
          updateHydrationProgress();
        });
      });
      document.getElementById('clearChecklist').addEventListener('click', ()=>{
        document.querySelectorAll('#dailyChecklist input[type=checkbox]').forEach(cb=>{ cb.checked=false; storage.set('check_'+cb.dataset.key,false)});
        renderRecent('Checklist cleared');
        updateHydrationProgress();
      });
    }
    initChecklist();

    /* ==========================
       Newsletter subscribe
       ========================== */
    document.getElementById('subscribeBtn').addEventListener('click', ()=>{
      const email = document.getElementById('newsletterEmail').value.trim();
      if(!email || !email.includes('@')){ document.getElementById('subscribeMsg').textContent = 'Enter a valid email.'; return; }
      const list = storage.get('subscribers',[]);
      if(list.includes(email)){ document.getElementById('subscribeMsg').textContent = 'Already subscribed.'; return; }
      list.push(email); storage.set('subscribers', list);
      document.getElementById('subscribeMsg').textContent = 'Thanks for joining HealthSync+!';
      renderRecent('Subscribed: ' + email);
      document.getElementById('newsletterEmail').value='';
    });

    /* ==========================
       Mood logs
       ========================== */
    function renderMoodList(){
      const list = storage.get('moodLogs',[]);
      const container = document.getElementById('moodList');
      container.innerHTML = '';
      list.slice().reverse().forEach(m=>{
        const li = document.createElement('li'); li.className='tiny'; li.style.padding='8px 0';
        li.textContent = `${m.when} â€” ${m.mood} ${m.note?(' â€” ' + m.note):''}`;
        container.appendChild(li);
      });
    }
    document.getElementById('addMood').addEventListener('click', ()=>{
      const mood = document.getElementById('moodSelect').value;
      const note = document.getElementById('moodNote').value.trim();
      const list = storage.get('moodLogs',[]);
      list.push({mood,note,when:new Date().toLocaleString()});
      storage.set('moodLogs',list);
      document.getElementById('moodNote').value='';
      renderMoodList();
      renderRecent('Mood logged');
    });
    renderMoodList();

    /* ==========================
       Simple charts (Chart.js)
       ========================== */
    const sampleSteps = storage.get('stepsWeek', [1200,3400,4500,6700,2300,7600,4200]);
    function initCharts(){
      const ctx1 = document.getElementById('stepsChart').getContext('2d');
      window.stepsChart = new Chart(ctx1, {
        type:'bar',
        data:{
          labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
          datasets:[{label:'Steps', data: sampleSteps, borderRadius:8}]
        },
        options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
      });

      const ctx2 = document.getElementById('sleepChart').getContext('2d');
      window.sleepChart = new Chart(ctx2, {
        type:'line',
        data:{labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],datasets:[{label:'Sleep hrs',data:[6,7.5,5.5,8,7,6.5,7],fill:true,tension:0.4}]},
        options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:false}}}
      });

      const ctx3 = document.getElementById('moodChart').getContext('2d');
      window.moodChart = new Chart(ctx3, {
        type:'line',
        data:{labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],datasets:[{label:'Mood (1-5)',data:[3,4,2,5,4,3,4],tension:0.4}]},
        options:{plugins:{legend:{display:false}},scales:{y:{min:0,max:5}}}
      });
    }
    initCharts();

    /* ==========================
       Basic simulated AI insights
       ========================== */
    function generateInsights(){
      const insights = [];
      const sleepHours = storage.get('lastSleep', 6.2);
      const water = storage.get('waterCount', 0);
      const moodLogs = storage.get('moodLogs',[]);
      const stepsToday = storage.get('stepsToday', 3200);

      if(sleepHours < 6) insights.push('You slept less than 6 hrs â€” try a quick nap or a power-rest today.');
      else if(sleepHours < 7) insights.push('Sleep was a bit short â€” aim for 7â€“8 hrs for better cognitive function.');
      else insights.push('Nice sleep last night â€” keep the routine consistent.');

      if(water < 4) insights.push('You have logged fewer than 4 glasses â€” time for a glass of water ðŸ’§');
      else if(water < 8) insights.push('You are halfway to your water goal â€” keep sipping!');
      else insights.push('Great â€” you reached your hydration goal today!');

      if(moodLogs.length === 0) insights.push('You haven\'t logged any mood entries this week â€” how are you feeling?');
      if(stepsToday < 3000) insights.push('Try a short 15-min walk â€” even short walks can improve mood and circulation.');

      return {insights,meta:{sleepHours,water,stepsToday}};
    }

    function renderInsights(){
      const out = generateInsights();
      const div = document.getElementById('insights');
      div.innerHTML = '';
      out.insights.forEach(i=>{
        const p = document.createElement('div'); p.className='tiny'; p.style.margin='6px 0';
        p.textContent = 'â€¢ ' + i;
        div.appendChild(p);
      });
      document.getElementById('insightTime').textContent = new Date().toLocaleTimeString();
      // quick update stat boxes
      document.getElementById('sleepHours').textContent = (storage.get('lastSleep',6.2)) + ' hr';
      document.getElementById('waterCount').textContent = storage.get('waterCount',0) + ' / 8';
      document.getElementById('stepsCount').textContent = storage.get('stepsToday', 0);
    }
    renderInsights();

    /* ==========================
       Heartbeat (simulated)
       ========================== */
    function simulateHeart(){
      const el = document.getElementById('heartBeat');
      const hr = Math.floor(60 + Math.random()*30);
      el.textContent = hr;
      // scale pulse speed by hr
      const rate = 1000 + Math.round(60000/hr) - 600;
      el.style.animationDuration = (1.05 + Math.random()*0.3) + 's';
    }
    setInterval(simulateHeart, 2500);
    simulateHeart();

    /* ==========================
       Breathing exercise
       ========================== */
    let breathTimer=null;
    function startBreathing(duration=60, targetElId='breathingCtl', progressElId='breathingProgress'){
      const el = document.getElementById(targetElId);
      const prog = document.getElementById(progressElId);
      const start = Date.now();
      let phase=0;
      el.textContent = 'Inhale';
      if(breathTimer) clearInterval(breathTimer);
      breathTimer = setInterval(()=>{
        const elapsed = Math.floor((Date.now()-start)/1000);
        if(elapsed>=duration){ stopBreathing(); prog && (prog.textContent='Completed'); return;}
        const cycle = elapsed % 6; // 6-second cycle: inhale 3s, exhale 3s
        if(cycle < 3){ el.style.transform='scale(1.08)'; el.textContent='Inhale'; }
        else { el.style.transform='scale(0.86)'; el.textContent='Exhale'; }
        prog && (prog.textContent = `Breathing â€” ${elapsed}s / ${duration}s`);
      }, 600);
    }
    function stopBreathing(){
      if(breathTimer) clearInterval(breathTimer);
      breathTimer=null;
      document.getElementById('breathingCtl').style.transform='scale(1)';
      document.getElementById('breathingCtl').textContent='Breathe';
      document.getElementById('breathingProgress') && (document.getElementById('breathingProgress').textContent='Stopped');
    }
    document.getElementById('startBreath').addEventListener('click', ()=>startBreathing(60,'breathingCtl'));
    document.getElementById('stopBreath').addEventListener('click', stopBreathing);
    document.getElementById('startBreath2').addEventListener('click', ()=>startBreathing(60,'breathingCtl','breathingProgress'));
    document.getElementById('stopBreath2').addEventListener('click', stopBreathing);

    /* ==========================
       Water reminder with sound
       ========================== */
    let waterInterval=null;
    const chime = new Audio('https://actions.google.com/sounds/v1/alarms/medium_bell_ringing_near.ogg'); // CDN sound
    document.getElementById('startRemBtn').addEventListener('click', ()=>startWaterReminder());
    document.getElementById('stopRemBtn').addEventListener('click', ()=>stopWaterReminder());
    function startWaterReminder(){
      if(waterInterval) return;
      // For demo: remind every 2 minutes instead of 2 hours. Change to 2*60*60*1000 for 2 hours.
      waterInterval = setInterval(()=>{
        chime.play().catch(()=>{});
        alert('Time to drink water ðŸ’§');
        renderRecent('Water reminder fired');
      }, 2*60*1000);
      renderRecent('Water reminders started');
    }
    function stopWaterReminder(){
      if(waterInterval){ clearInterval(waterInterval); waterInterval=null; renderRecent('Water reminders stopped');}
    }
    // backward-compatible button id mismatch handlers
    function startWaterReminder(){ if(waterInterval) return; waterInterval = setInterval(()=>{ chime.play().catch(()=>{}); alert('Time to drink water ðŸ’§'); renderRecent('Water reminder fired'); }, 2*60*1000 ); renderRecent('Water reminders started'); }
    function stopWaterReminder(){ if(waterInterval){ clearInterval(waterInterval); waterInterval=null; renderRecent('Water reminders stopped'); } }

    /* ==========================
       Hydration challenge tracking
       ========================== */
    function updateHydrationProgress(){
      const value = storage.get('challengeHydration',3);
      const pct = Math.min(100, Math.round((value/7)*100));
      document.getElementById('hydrationProgress').style.width = pct + '%';
      document.getElementById('challengeProg').style.width = pct + '%';
      document.getElementById('challengeProg').parentNode && (document.getElementById('challengeProg').parentNode.querySelector('.small') || {});
    }
    document.getElementById('joinChallenge').addEventListener('click', ()=>{
      storage.set('challengeHydration', storage.get('challengeHydration',0)+1);
      updateHydrationProgress();
      renderRecent('Joined hydration challenge');
    });
    document.getElementById('logGlass').addEventListener('click', ()=>{
      const v = storage.get('challengeHydration',0)+1; storage.set('challengeHydration', v);
      const waterCount = Math.min(8, storage.get('waterCount',0)+1); storage.set('waterCount', waterCount);
      updateHydrationProgress(); renderInsights(); renderRecent('Logged a glass of water');
    });
    updateHydrationProgress();

    /* ==========================
       BMI & Calorie calculator
       ========================== */
    document.getElementById('calcBtn').addEventListener('click', ()=>{
      const h = parseFloat(document.getElementById('heightInput').value);
      const w = parseFloat(document.getElementById('weightInput').value);
      const activity = parseFloat(document.getElementById('activityLevel').value);
      if(!h || !w){ document.getElementById('bmiResult').textContent = 'Enter height and weight.'; return; }
      const bmi = (w / ((h/100)*(h/100))).toFixed(1);
      let cat='Normal';
      if(bmi<18.5) cat='Underweight'; else if(bmi<25) cat='Normal'; else if(bmi<30) cat='Overweight'; else cat='Obese';
      // simple BMR (Mifflin-St Jeor) assume male; for demo only
      const bmr = Math.round(10*w + 6.25*h - 5*25 + 5);
      const calories = Math.round(bmr * activity);
      document.getElementById('bmiResult').innerHTML = `BMI: <strong>${bmi}</strong> â€” ${cat}. Estimated daily calories: <strong>${calories}</strong> kcal (approx).`;
      renderRecent('Calculated BMI & calories');
    });
    document.getElementById('clearCalc').addEventListener('click', ()=>{ document.getElementById('heightInput').value=''; document.getElementById('weightInput').value=''; document.getElementById('bmiResult').textContent=''; });

    /* ==========================
       Virtual symptom checker
       ========================== */
    document.getElementById('checkSymptom').addEventListener('click', ()=>{
      const s = document.getElementById('symptomSel').value;
      const adviceBox = document.getElementById('symptomAdvice');
      if(!s){ adviceBox.textContent = 'Choose a symptom to get simulated advice.'; return; }
      let txt='';
      if(s==='Headache') txt='Headache â†’ consider hydration, eye breaks, and rest; if severe, consult a doctor.';
      else if(s==='Fatigue') txt='Fatigue â†’ ensure 7â€“8 hrs sleep, balanced diet; if persistent, check iron levels and see a clinician.';
      else if(s==='Cough') txt='Cough â†’ rest, fluids, see a doctor if fever or shortness of breath.';
      else if(s==='Stomach ache') txt='Stomach ache â†’ try light foods; seek care if severe or persistent.';
      else if(s==='Back pain') txt='Back pain â†’ gentle stretching, posture correction; see physio if ongoing.';
      adviceBox.textContent = txt;
      renderRecent('Checked symptom: ' + s);
    });

    /* ==========================
       Motivational quotes (rotate daily)
       ========================== */
    const QUOTES = [
      "Health is the greatest wealth.",
      "Consistency beats intensity.",
      "Small daily habits lead to big changes.",
      "Take care of your body â€” itâ€™s the only place you have to live.",
      "A short walk is better than no walk."
    ];
    function currentQuote(){ return QUOTES[(new Date()).getDate() % QUOTES.length]; }
    document.getElementById('quoteText').textContent = currentQuote();
    document.getElementById('newQuote').addEventListener('click', ()=> {
      const q = QUOTES[Math.floor(Math.random()*QUOTES.length)]; document.getElementById('quoteText').textContent = q;
    });

    /* ==========================
       Recent logs rendering
       ========================== */
    function renderRecent(text){
      const arr = storage.get('recent',[]);
      arr.push({t:new Date().toLocaleString(), text});
      storage.set('recent', arr.slice(-20));
      const el = document.getElementById('recentLogs');
      el.innerHTML = arr.slice().reverse().map(r=>`<div style="padding:6px 0">${r.t} â€” ${r.text}</div>`).join('') || 'No activity';
    }
    renderRecent('App opened');

    /* ==========================
       Simple inputs for sample data
       ========================== */
    // For demo: allow user to update steps/sleep/water quickly via console-like prompt
    document.getElementById('addLogBtn').addEventListener('click', ()=>{
      const type = prompt('Add log type (steps/sleep/water):','steps');
      if(!type) return;
      if(type==='steps'){ const v = parseInt(prompt('Enter steps number:', '3500')||0); storage.set('stepsToday', v); renderInsights(); renderRecent('Steps set to '+v); window.stepsChart.data.datasets[0].data[6]=v; window.stepsChart.update(); }
      else if(type==='sleep'){ const v = parseFloat(prompt('Hours of sleep:', '6.5')||0); storage.set('lastSleep', v); renderInsights(); renderRecent('Sleep set to '+v); }
      else if(type==='water'){ const v = parseInt(prompt('Number of glasses:', '3')||0); storage.set('waterCount', v); renderInsights(); renderRecent('Water set to '+v); updateHydrationProgress(); }
      else alert('Unknown type');
    });

    /* ==========================
       Symptom checks & AI update intervals
       ========================== */
    setInterval(()=>{ renderInsights(); }, 60*1000);

    /* ==========================
       Symptom advice persistence and startup
       ========================== */
    (function startup(){
      // load some demo values to make the UI lively if empty
      if(!localStorage.getItem('hasDemo')){
        storage.set('stepsToday', 3200);
        storage.set('lastSleep', 6.2);
        storage.set('waterCount', 2);
        storage.set('challengeHydration', 3);
        storage.set('moodLogs', [{mood:'Neutral',note:'Busy day',when:new Date().toLocaleString()}]);
        localStorage.setItem('hasDemo', '1');
      }
      renderInsights(); renderMoodList(); renderRecent('Demo data loaded');
      document.getElementById('lastSync').textContent = 'Last sync: ' + (new Date()).toLocaleString();
    })();

    /* ==========================
       Symptom advice quick triggers
       ========================== */
    document.getElementById('checkSymptom').addEventListener('click', ()=>{ /* handled above */ });

    /* ==========================
       Final polish: update charts periodically (simulate)
       ========================== */
    setInterval(()=>{
      // random walk for demo
      const idx = new Date().getDay() - 1; // 0-6
      if(idx<0) return;
      const delta = Math.round((Math.random()-0.4)*1000);
      window.stepsChart.data.datasets[0].data[idx] = Math.max(0, (window.stepsChart.data.datasets[0].data[idx] || 2000) + delta);
      window.stepsChart.update();
    }, 45*1000);

    /* ==========================
       Symptom helper (keyboard shortcut)
       ========================== */
    document.addEventListener('keydown', (e)=>{ if(e.key==='/' && e.ctrlKey){ showSection('tools'); document.getElementById('symptomSel').focus(); } });

    /* ==========================
       Simple accessibility tweaks
       ========================== */
    document.querySelectorAll('button').forEach(b=>b.setAttribute('role','button'));

    /* ==========================
       End of app script
       ========================== */
  </script>
</body>
</html> 
